{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Acesso e Cadastro</title>
<link rel="icon" href="{% static 'img/favi.png' %}" type="image/x-icon">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
/* --- CONFIGURAÇÃO GERAL --- */
*{box-sizing:border-box;}
body{font-family:'Poppins',sans-serif;background:#f6f5f7;display:flex;justify-content:center;align-items:center;flex-direction:column;height:100vh;margin:0;color:#333;}
/* --- CONTAINERS --- */
.container{background-color:#fff;position:relative;overflow:hidden;width:100vw;height:100vh;}
.form-container{position:absolute;top:0;height:100%;transition:all .6s ease-in-out;}
.sign-in-container{left:0;width:50%;z-index:2;}
.sign-up-container{left:0;width:50%;opacity:0;z-index:1;}
.container.right-panel-active .sign-in-container{transform:translateX(100%);}
.container.right-panel-active .sign-up-container{transform:translateX(100%);opacity:1;z-index:5;animation:show .6s;}
@keyframes show{0%,49.99%{opacity:0;z-index:1;}50%,100%{opacity:1;z-index:5;}}
/* --- OVERLAY --- */
.overlay-container{position:absolute;top:0;left:50%;width:50%;height:100%;overflow:hidden;transition:transform .6s ease-in-out;z-index:100;}
.container.right-panel-active .overlay-container{transform:translateX(-100%);}
.overlay{background:#FFFFFF;position:relative;left:-100%;height:100%;width:200%;transform:translateX(0);transition:transform .6s ease-in-out;}
.container.right-panel-active .overlay{transform:translateX(50%);}
.overlay-panel{position:absolute;display:flex;align-items:center;justify-content:center;flex-direction:column;padding:0 40px;text-align:center;top:0;height:100%;width:50%;transform:translateX(0);transition:transform .6s ease-in-out;}
.overlay-panel img{max-width:80%;max-height:400px;object-fit:contain;margin-bottom:20px;}
.overlay-left{transform:translateX(-20%);}
.container.right-panel-active .overlay-left{transform:translateX(0);}
.overlay-right{right:0;transform:translateX(0);}
.container.right-panel-active .overlay-right{transform:translateX(20%);}
/* --- FORMULÁRIOS --- */
form{background-color:#FFFFFF;display:flex;align-items:center;justify-content:center;flex-direction:column;padding:0 50px;height:100%;text-align:center;}
/* --- TITULOS --- */
h1,h2{font-weight:600;margin:0 0 1.2rem;color:#222;text-align:center;letter-spacing:0.5px;}
h1{font-size:2rem;}
h2{font-size:1.6rem;}
/* --- CAMPOS DE TEXTO --- */
input{width:80%;padding:14px 16px;margin:10px auto;border:1px solid #ddd;border-radius:10px;background:#fafafa;font-size:15px;font-weight:400;transition:all 0.2s ease;}
input:focus{outline:none;border-color:#26A0B8;background:#fff;box-shadow:0 0 0 2px rgba(38,160,184,0.15);}
/* --- BOTÕES PRINCIPAIS --- */
.button-group{display:flex;justify-content:center;gap:15px;width:100%;margin-top:20px;}
button{border-radius:12px;border:none;background-color:#26A0B8;color:#FFFFFF;font-size:15px;font-weight:600;padding:14px 42px;text-transform:uppercase;letter-spacing:0.5px;cursor:pointer;transition:all 0.25s ease;}
button:hover{background-color:#1e8aa0;}
button.register-btn{background-color:#EB9941;}
button.register-btn:hover{background-color:#d87f28;}
button:active{transform:scale(.96);}
button:focus{outline:none;}
/* --- BOTÕES DESLIZANTES (OVERLAY) --- */
button.ghost{border-radius:12px;border:1.5px solid transparent;background-color:transparent;color:#333;padding:12px 34px;font-weight:600;text-transform:uppercase;letter-spacing:0.5px;cursor:pointer;transition:all 0.25s ease;}
/* Botão "Entrar" deslizante → transparente, azul no hover */
.overlay-left button.ghost{border-color:#26A0B8;color:#26A0B8;}
.overlay-left button.ghost:hover{background-color:#26A0B8;color:#fff;}
/* Botão "Cadastrar" deslizante → transparente, laranja no hover */
.overlay-right button.ghost{border-color:#EB9941;color:#EB9941;}
.overlay-right button.ghost:hover{background-color:#EB9941;color:#fff;}
/* --- LINKS --- */
.links{text-align:center;margin-top:20px;}
.links a{color:#26A0B8;font-size:15px;font-weight:500;text-decoration:none;transition:color 0.2s;}
.links a:hover{color:#1e8aa0;}
/* --- MENSAGENS DE ERRO --- */
.login-error-message{background-color:#f8d7da;color:#721c24;padding:14px;width:100%;border-radius:8px;border:1px solid #f5c6cb;margin-bottom:18px;text-align:center;font-size:15px;font-weight:500;}
/* --- CAPTCHA --- */
.captcha-container{width:80%;padding:14px 16px;border:1px solid #ddd;border-radius:10px;margin:10px auto;background-color:#fafafa;display:flex;flex-direction:column;align-items:center;gap:12px;font-size:15px;font-weight:500;}
.captcha-image-container{display:flex;align-items:center;justify-content:center;gap:10px;width:100%;}
#captcha-refresh-btn{font-size:1.3rem;cursor:pointer;color:#555;}
.captcha-container #id_captcha_1{width:100%;padding:14px 16px;border:1px solid #ddd;border-radius:10px;background:#fff;font-size:15px;text-align:center;letter-spacing:5px;}
/* --- INPUT GROUP --- */
.input-group{display:flex;gap:10px;width:80%;margin:8px auto;justify-content:center;}
.input-group input{margin:0;width:100%;}
/* --- ERROS DE VALIDAÇÃO --- */
.error-message{color:red;font-size:14px;display:none;margin-top:10px;width:100%;}
/* --- TOAST / NOTIFICAÇÕES --- */
#toast-container{position:fixed;top:20px;right:20px;z-index:2000;display:flex;flex-direction:column;align-items:flex-end;gap:10px;}
.toast-notification{background-color:#fff;color:#333;padding:15px 20px;border-radius:10px;box-shadow:0 4px 12px rgba(0,0,0,.15);max-width:350px;display:flex;align-items:center;gap:10px;transform:translateX(120%);transition:transform .4s ease-out,opacity .4s ease-out;opacity:0;}
.toast-notification.show{transform:translateX(0);opacity:1;}
.toast-icon{font-size:24px;}
.toast-message{flex-grow:1;font-size:15px;font-weight:500;line-height:1.5;}
.toast-close-btn{background:none;border:none;font-size:20px;color:#999;cursor:pointer;transition:color .2s;}
.toast-notification.success .toast-icon{color:#28a745;}
.toast-notification.error .toast-icon{color:#dc3545;}
</style>
</head>
<body>
<div class="container" id="container">
<div class="form-container sign-up-container">
<form id="formCadastro" action="/cadastrar/" method="POST">
{% csrf_token %}
<h2>Criar Conta</h2>
<input type="text" name="nomecompleto" placeholder="Nome Completo*" required pattern="[A-Za-zÀ-ÿ ]+" title="Deve conter apenas letras.">
<input type="text" name="usuario" placeholder="Usuário*" required pattern="[A-Za-z0-9]+" title="Deve conter apenas letras e números.">
<input type="email" name="email" placeholder="Email*" required>
<input type="text" name="celular" placeholder="Celular*" required pattern="\d+" title="Deve conter apenas números.">
<div class="input-group">
<input type="password" name="senha" placeholder="Senha*" required minlength="8" title="A senha deve ter no mínimo 8 caracteres.">
<input type="password" name="repetir_senha" placeholder="Repetir Senha*" required>
</div>
<span class="error-message" id="errorMessage">As senhas não coincidem.</span>
<div class="button-group">
<button type="submit" class="register-btn">Cadastrar</button>
</div>
<div class="links">
<a href="#" id="signInFormLink">Já tem cadastro? Entre agora</a>
</div>
</form>
</div>
<div class="form-container sign-in-container">
<form id="formLogin" action="{% url 'login' %}" method="POST" autocomplete="off">
{% csrf_token %}
<h2>Acesso ao Usuário</h2>
{% if messages %}
{% for message in messages %}
<div class="login-error-message {{ message.tags }}">
<i class="fas fa-exclamation-circle"></i> {{ message }}
</div>
{% endfor %}
{% endif %}
<input type="text" name="login_usuario" placeholder="Usuário" required>
<input type="password" name="password" placeholder="Senha" required>
{% if show_captcha %}
<div class="captcha-container">
<div class="captcha-image-container">
{{ captcha_form.captcha }}
<i class="fas fa-sync-alt" id="captcha-refresh-btn" title="Trocar imagem"></i>
</div>
</div>
{% endif %}
<div class="button-group">
<button type="submit">Entrar</button>
<button type="button" class="register-btn" id="signUpFormBtn">Cadastrar</button>
</div>
<div class="links">
<a href="{% url 'senha' %}">Esqueci minha senha</a>
</div>
</form>
</div>
<div class="overlay-container">
<div class="overlay">
<div class="overlay-panel overlay-left">
<img src="{% static 'img/logo.png' %}" alt="Logo">
</div>
<div class="overlay-panel overlay-right">
<img src="{% static 'img/logo.png' %}" alt="Logo">
</div>
</div>
</div>
</div>
<div id="toast-container"></div>
<script>
// --- 1. SCRIPT DA ANIMAÇÃO DO PAINEL ---
const signUpButton = document.getElementById('signUp');
const signInButton = document.getElementById('signIn');
const container = document.getElementById('container');
const signUpFormBtn = document.getElementById('signUpFormBtn');
const signInFormLink = document.getElementById('signInFormLink');
if (signUpFormBtn) {
signUpFormBtn.addEventListener('click', () => {container.classList.add("right-panel-active");});
}
if (signInFormLink) {
signInFormLink.addEventListener('click', (e) => {
e.preventDefault();
container.classList.remove("right-panel-active");
});
}
// --- 2. FUNÇÃO PARA MOSTRAR NOTIFICAÇÕES (TOAST) ---
function showToast(type,message,duration=3000){const c=document.getElementById('toast-container');const t=document.createElement('div');t.className=`toast-notification ${type}`;let i='';if(type==='success'){i='fa-check-circle';}else if(type==='error'){i='fa-exclamation-circle';}else{i='fa-info-circle';}t.innerHTML=`<i class="toast-icon fas ${i}"></i><span class="toast-message">${message}</span><button class="toast-close-btn">&times;</button>`;c.appendChild(t);void t.offsetWidth;t.classList.add('show');const o=setTimeout(()=>{t.classList.remove('show');setTimeout(()=>{t.remove();},400);},duration);t.querySelector('.toast-close-btn').addEventListener('click',()=>{clearTimeout(o);t.classList.remove('show');setTimeout(()=>{t.remove();},400);});}
// --- 3. SCRIPT DO FORMULÁRIO DE CADASTRO (AJAX) ---
const formCadastro=document.getElementById('formCadastro');formCadastro.addEventListener('submit',function(event){event.preventDefault();const senha=this.senha.value;const repetirSenha=this.repetir_senha.value;const errorMessage=document.getElementById('errorMessage');if(senha!==repetirSenha){errorMessage.style.display='block';return;}else{errorMessage.style.display='none';}const form=new FormData(this);fetch(this.action,{method:'POST',body:form,headers:{'X-Requested-With':'XMLHttpRequest'}}).then(response=>response.json()).then(data=>{if(data.success){showToast('success',data.message||'Cadastro realizado com sucesso!');this.reset();if(signInFormLink){signInFormLink.click();}}else{showToast('error',data.message||'Ocorreu um erro ao cadastrar.');}}).catch(error=>{showToast('error','Erro de conexão. Tente novamente.');console.error('Erro:',error);});});
// --- 4. SCRIPT DO CAPTCHA ---
const refreshButton=document.getElementById('captcha-refresh-btn');if(refreshButton){refreshButton.addEventListener('click',function(e){e.preventDefault();fetch('/captcha/refresh/',{method:'GET',headers:{'X-Requested-With':'XMLHttpRequest'}}).then(response=>response.json()).then(data=>{if(data&&data.key&&data.image_url){document.querySelector('.captcha').src=data.image_url;document.getElementById('id_captcha_0').value=data.key;const textInput=document.getElementById('id_captcha_1');if(textInput){textInput.value='';textInput.focus();}}}).catch(error=>console.error('Erro ao atualizar o CAPTCHA:',error));});}
</script>
</body>
</html>